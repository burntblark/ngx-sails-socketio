{"version":3,"file":"sails.request.criteria.js","sourceRoot":"","sources":["../src/sails.request.criteria.ts"],"names":[],"mappings":"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","sourcesContent":["import { isUndefined, isString, isEmptyObject, isObject } from \"./utils\";\n\nexport class RequestCriteria {\n\n    public or(): RequestCriteria {\n        if (isUndefined(this.orCriteria[\"or\"])) {\n            this.orCriteria[\"or\"] = [this.criteria];\n            this.criteria = {};\n            return this;\n        }\n        if (Array.isArray(this.orCriteria[\"or\"])) {\n            this.orCriteria[\"or\"].push(this.criteria);\n        } else if (isObject(this.criteria[\"or\"])) {\n            this.orCriteria[\"or\"] = [this.criteria];\n        }\n        this.criteria = {};\n        return this;\n    }\n\n    public whereNotEqualTo(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"!\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"!\"])) {\n            this.criteria[key][\"!\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: ! clause, use whereNotIn instead\");\n    }\n\n    public whereLike(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"like\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"like\"])) {\n            this.criteria[key][\"like\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: like clause has already been used in this query\");\n    }\n\n    public whereEqualTo(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: contains clause has already been used in this query\");\n    }\n\n    public whereContains(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"contains\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"contains\"])) {\n            this.criteria[key][\"contains\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: contains clause has already been used in this query\");\n    }\n\n    public whereIn(key: string, ...value: string[]): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: contains clause has already been used in this query\");\n    }\n\n    public whereStartsWith(key: string, value: string): RequestCriteria {\n        if (isString(this.criteria[key])) {\n            this.criteria[key] = { \"startsWith\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"startsWith\"])) {\n            this.criteria[key][\"startsWith\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: startsWith clause has already been used in this query\");\n    }\n\n    public whereEndsWith(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"endsWith\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"endsWith\"])) {\n            this.criteria[key][\"endsWith\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: endsWith clause has already been used in this query\");\n    }\n\n    public whereNotIn(key: string, value: string): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"!\": [value] };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"!\"])) {\n            this.criteria[key][\"!\"] = [value];\n            return this;\n        }\n        if (Array.isArray(this.criteria[key][\"!\"])) {\n            this.criteria[key][\"!\"].push(value);\n        } else {\n            this.criteria[key][\"!\"] = [this.criteria[key][\"!\"], value];\n        }\n        return this;\n    }\n\n    public whereLessThan(key: string, value: string | number | boolean | Date): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"<\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"<\"])) {\n            this.criteria[key][\"<\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: < clause has already been used in this query\");\n    }\n\n    public whereLessThanOrEqualTo(key: string, value: string | number | boolean | Date): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \"<=\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\"<=\"])) {\n            this.criteria[key][\"<=\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: <= clause has already been used in this query\");\n    }\n\n    public whereGreaterThan(key: string, value: string | number | boolean | Date): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \">\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\">\"])) {\n            this.criteria[key][\">\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: > clause has already been used in this query\");\n    }\n\n    public whereGreaterThanOrEqualTo(key: string, value: string | number | boolean | Date): RequestCriteria {\n        if (isUndefined(this.criteria[key]) || isString(this.criteria[key])) {\n            this.criteria[key] = { \">=\": value };\n            return this;\n        }\n        if (isUndefined(this.criteria[key][\">=\"])) {\n            this.criteria[key][\">=\"] = value;\n            return this;\n        }\n        throw new Error(\"DuplicateError: >= clause has already been used in this query\");\n    }\n\n    private criteria: object = {};\n    private orCriteria: object = {};\n\n    private build(): string {\n        if (isEmptyObject(this.criteria)) {\n            return \"\";\n        }\n        const stringify = criteria => JSON.stringify(criteria);\n\n        if (!isEmptyObject(this.orCriteria)) {\n            if (Array.isArray(this.orCriteria[\"or\"])) {\n                this.orCriteria[\"or\"].push(this.criteria);\n            }\n            return stringify(this.orCriteria);\n        }\n        return stringify(this.criteria);\n    }\n\n    public toString() {\n        return this.build();\n    }\n}\n"]}